function Ind = patchind(iter,nsz,coefsz)
nc = imsz(2) - psz(2);
Ind = [];
k = 1;

rec_x = floor((iter-1)/nc)+1;
rec_y = iter-(rec_x-1)*nc;

l = min(nsz(1),rec_x-1);
r = min(nsz(1),coefsz(1) - rec_x);



for i = -nsz(1):nsz(1)
    for j = -nsz(2):nsz(2)
        if rec_x+i >0 & rec_y+j >0 & rec_x+i <=imsz(1)-psz(1)+1 & rec_y+j<=imsz(2)-psz(2)+1,
            Ind(k) = iter+i*nc+j;
            k = k+1;
        end
    end
end

